# Настройка ученического компьютера на ОС Windows

В этой инструкции описаны методы настройки ОС Windows, которые помогут:

1. Запретить изменение фонового рисунка рабочего стола
2. Запретить изменение прочих настроек персонализации (тема, вид курсора, панель задач, и многое другое)
3. Автоматически очищать рабочий стол от файлов (без их удаления)
4. Бороться с переименованием значков "Компьютер", "Корзина", и т.д.

Работоспособность приведённых ниже методов проверена на Windows 10, Windows 7, но, скорее всего, они будут работать и на более старших версиях ОС Windows.

## Шаг 1. Учетная запись ученика должна быть с обычными правами

Это важно, потому что с правами администратора все запреты довольно легко отключить. Если на компьютере есть только одна учетная запись, и отдельной учётной записи для ученика нет, нужно создать ещё одну, специально для ученика. Можете воспользоваться одним из руководств ниже:

<details>
  <summary><b>Добавление пользователя Windows 10</b></summary>

**Пуск** --> **Параметры**. В указанном пункте настроек откройте раздел **Семья и другие пользователи**
В разделе **Другие пользователи** выберите **Добавить пользователя на этот компьютер**

![Окно настроек пользователей Windows 10](/images/win_10/add_user_win10_1.png "Окно настроек пользователей Windows 10")

Появится окно, в котором будет предложено ввести email нового пользователя, если у него есть учетная запись Microsoft. Зачастую, для ученика это не нужно, и достаточно локальной учётной записи. Для этого выбираем ниже **У меня нет данных для входа этого человека**

![Окно настроек пользователей Windows 10](/images/win_10/add_user_win10_2.png "Окно настроек пользователей Windows 10")

В следующем окне выбираем **Добавить пользователя без учетной записи Майкрософт** внизу. 

![Окно настроек пользователей Windows 10](/images/win_10/add_user_win10_3.png "Окно настроек пользователей Windows 10")

В следующем окне останется ввести имя пользователя (желательно, латиницей), пароль (если требуется пользователь без пароля, просто не вводите ничего в соответствующие поля), подсказку для пароля и указать вопросы для восстановления пароля, на случай, если он будет забыт. Этого достаточно, теперь ученик сможет входить в систему под этой записью, а по умолчанию она имеет права обычного пользователя.

![Окно настроек пользователей Windows 10](/images/win_10/add_user_win10_4.png "Окно настроек пользователей Windows 10")

На этом добавление нового пользователя завершено.
</details>

<details>
  <summary><b>Добавление пользователя Windows 7</b></summary>

</details>

## Шаг 2. Настроить персонализацию в учётной записи ученика

Теперь нужно привести настройки персонализации к желаемому виду. Далее мы запретим их изменять, поэтому заранее настоим нужные:

1. Фоновый рисунок рабочего стола
2. Тему оформления
3. Цветовую схему
4. Звуковую схему (или её отсутствие)
5. Размер и вид курсора
6. Расположение и размер панели задач
7. Прочие настройки персонализации

После того, как все настройки внесены, переходим к следующему шагу

## Шаг 3. Запрет изменения настроек персонализации

Это можно сделать двумя способами:

  [1. Через редактор групповых политик gpedit.msc](######Настройка-с-помощью-редактора-групповых-политик-gpedit.msc).(затратно по времени, но есть возможность гибких настроек)
  
  [2. Внесение изменений в реестр напрямую (быстро, рекомендуется)](###Внесение-изменений-в-системный-реестр-напрямую).


  ### Настройка с помощью редактора групповых политик gpedit.msc
  
Откроем окно «Выполнить» (найдёте его в меню Пуск, а также можно открыть сочетанием <i>WIN + R</i>), и наберём там команду <b>gpedit.msc</b>. Жмём Enter, и если всё хорошо — видим окно редактора:
  
  ![Редактор групповых политик gpedit.msc](/images/gpedit/gpedit_main.png "Окно редактора групповых политик")
  
  а если нет — вот такое сообщение:
  
  ![Ошибка gpedit.msc](/images/gpedit/cannot_find_gpedit_error.png "Ошибка - редактор групповых политик не найден")
  
  В случае ошибки, можно установить gpedit.msc [вручную](https://github.com/auto-no-mous/Clean-school-computer-win/blob/main/gpedit-error-fix.md)
  
  ### Приступим к настройке запретов
  
  После того, как редактор групповых политик gpedit.msc запущен, первое, и самое главное - запретить изменение фонового рисунка.
  
  Для этого откроем раздел Конфигурация пользователя → Административные  шаблоны → Панель управления → Персонализация. (User Configuration → Administrative templates → Control Panel → Display)
  
  ![Редактор групповых политик - Персонализация](/images/gpedit/gpedit_personalization.png "Персонализация")
  
  В правой части окна найдём параметр "Запрет изменения фона рабочего стола" (Prevent changing wallpaper). Двойным кликом откроем окно настройки этого параметра, и выберем "Включено", затем нажмём ОК.
  
   ![Редактор групповых политик - Окно настроек параметра](/images/gpedit/gpedit_option_window.png "Окно настроек параметра")
  
  Уже после этой опции, желательно [проверить работособность настроек](##Шаг-4.-Проверка-работоспособности-запрещающих-настроек). Если всё работает, продолжаем.
  


  
  ### Внесение изменений в системный реестр напрямую
  
  ЗАПОЛНИТЕЛЬ
  
  

Для большинства случаев, рекомендуется 2-й способ.

  ## Шаг 4. Проверка работоспособности запрещающих настроек
  
  Теперь нужно проверить, влияют ли настройки на систему. Попробуйте изменить фоновый рисунок рабочего стола (перезагрузка не нужна, настройки должны влиять сразу просле их включения).
  
  **ПРИМЕЧАНИЕ 1**
  *Иногда, даже если настройка работает, удаётся **один раз** изменить фоновый рисунок. Повторная смена уже не сработает. Это баг Windows, но ничего страшного в этом нет, просто снимем запрет, и снова установим нужные обои.*
  
   **ПРИМЕЧАНИЕ 2** 
  *Программы "Paint", "Paint 3D", и возможно, некоторые другие имеют встроенные команды по изменению фонового рисунка, и каким-то образом также позволяют **один раз** изменить фоновый рисунок в обход запрета. Это работает отдельно от смены рисунка из настроек персонализации, или меню при просмотре изображения встроенными программами. Соответственно, после установки ограничения, желательно просто открыть желаемый файл с фоновым рисунком через Paint, и установить его еще раз.*
  
  Если после всех этих действий, у вас более никаким образом не получается изменить фон рабочего стола - поздравляю, всё работает. Если вы пользовались первым способом, и настройки не сработали, а фон всё также можно менять - воспользуйтесь [включением настроек напрямую через реестр (способ № 2)](###Внесение-изменений-в-системный-реестр-напрямую).
